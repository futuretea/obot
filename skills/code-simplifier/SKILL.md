---
name: code-simplifier
description: |
  简化和优化代码，提升清晰度、一致性和可维护性，同时保留所有功能，优先作用于最近修改的代码。
  Use this skill to refactor and clean up code (refactor, clean up code, improve readability) without changing behavior, focusing on recently modified code.
---

# 代码简化器（Code Simplifier）

## 适用范围

本 Skill 适用于任何需要代码优化和重构的场景，专注于：

- 提升代码清晰度和可读性
- 保持一致的编码风格
- 增强代码可维护性
- 在不改变功能的前提下简化代码结构

主要针对**最近修改或当前会话中涉及的代码**，除非明确要求审查更广范围。

---

## 核心原则

作为代码简化专家，应在保持功能完全不变的前提下，通过应用项目最佳实践来简化和改进代码。优先考虑可读性和明确性，而非过度紧凑的解决方案。

### 1. 保留功能（Preserve Functionality）

- **绝不改变代码的功能** - 只改变实现方式
- 所有原始特性、输出和行为必须保持完整
- 任何重构都不应影响代码的实际效果

### 2. 应用项目标准（Apply Project Standards）

遵循项目中已建立的 Go 编码规范，包括但不限于：

- 遵循 Go 官方代码风格指南和 `gofmt` 格式化标准
- 优先使用简短、清晰的变量名（Go 惯用风格）
- 正确处理错误，避免忽略 error 返回值
- 保持接口小而专注，遵循 Go 接口设计原则
- 遵循项目现有的包组织和导入分组约定

### 3. 增强清晰度（Enhance Clarity）

通过以下方式简化代码结构：

- **减少不必要的复杂性和嵌套**
  - 降低代码层级，提高可读性
  - 避免过深的嵌套结构

- **消除冗余代码和抽象**
  - 移除重复的逻辑
  - 去掉不必要的中间层
  - 避免过度设计的接口和抽象

- **通过清晰的变量和函数名提升可读性**
  - 使用描述性强的命名
  - 避免模糊或缩写的名称

- **整合相关逻辑**
  - 将相关功能集中在一起
  - 保持逻辑的内聚性

- **移除描述显而易见代码的注释**
  - 只保留解释"为什么"的注释
  - 让代码本身说明"做什么"

- **重要：遵循 Go 惯用写法**
  - 避免复杂的控制流，优先使用 early return
  - 合理使用 Go 特有的语言特性（如 defer、goroutine、channel）
  - 避免过度使用反射和 interface{}
  - 保持函数简短，单一职责

- **选择清晰度而非简洁性**
  - 明确的代码通常优于过度紧凑的代码
  - 不要为了减少行数而牺牲可读性

### 4. 保持平衡（Maintain Balance）

避免过度简化，以下情况应当保留：

- **不应降低代码清晰度或可维护性**
  - 简化不应让代码更难理解

- **不应创建过于聪明的解决方案**
  - 避免难以理解的"技巧性"代码

- **不应将过多关注点合并到单个函数或组件中**
  - 保持单一职责原则
  - 适当的代码分离有助于维护

- **不应移除有助于代码组织的有益抽象**
  - 合理的抽象层能提升代码质量

- **不应优先考虑"更少的行数"而非可读性**
  - 避免嵌套三元运算符、密集的单行代码
  - 代码行数不是唯一的质量指标

- **不应让代码更难调试或扩展**
  - 保持代码的可维护性和可扩展性

### 5. 聚焦范围（Focus Scope）

- 仅优化**最近修改或当前会话中涉及的代码**
- 除非明确要求，否则不审查更广范围
- 专注于变更的部分，避免不必要的全局重构

---

## 优化流程

1. **识别最近修改的代码部分**
   - 确定变更范围和影响区域

2. **分析改进优雅性和一致性的机会**
   - 查找可简化的复杂逻辑
   - 识别不一致的编码风格

3. **应用项目特定的最佳实践和编码标准**
   - 遵循已建立的规范
   - 保持与现有代码的一致性

4. **确保所有功能保持不变**
   - 验证重构前后的行为一致
   - 不引入新的 bug

5. **验证优化后的代码更简单且更易维护**
   - 评估可读性是否提升
   - 确认维护成本降低

6. **仅记录影响理解的重要变更**
   - 不为显而易见的改动添加注释
   - 记录关键的重构决策

---

## 使用说明

### 自动优化模式

- 在代码编写或修改后**立即自动进行优化**
- 无需显式请求即可主动重构
- 确保所有代码符合最高标准的优雅性和可维护性

### 目标

在**完全保留功能**的前提下，确保所有代码达到：

- **最高的优雅性标准**
- **最佳的可维护性**
- **一致的项目风格**

---

## 注意事项

1. **功能优先**：任何情况下都不应改变代码的实际功能
2. **渐进式优化**：优先处理最近修改的代码，避免大范围重构
3. **保持平衡**：在简化和清晰度之间找到最佳平衡点
4. **项目一致性**：遵循项目现有的编码规范和风格
5. **可维护性**：始终考虑代码的长期可维护性